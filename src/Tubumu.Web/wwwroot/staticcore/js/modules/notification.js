webpackJsonp([8],{"/rEA":function(e,g,C){"use strict";(function(i){var e=C("//Fk"),a=C.n(e),t=C("mvHQ"),n=C.n(t),r=C("OvRC"),o=C.n(r),l=C("mtWM"),s=C.n(l),u=C("mw3O"),c=C.n(u),d=C("bzuE"),f="default",h="sysetem";function p(e,t,n){this.name="ApiError",this.message=e||"Default Message",this.errorType=t||f,this.innerError=n,this.stack=(new Error).stack}(p.prototype=o()(Error.prototype)).constructor=p;var m=s.a.create({baseURL:d.a,timeout:2e4,responseType:"json",withCredentials:!0});m.interceptors.request.use(function(e){return"post"===e.method||"put"===e.method||"patch"===e.method?(e.headers={"Content-Type":"application/json; charset=UTF-8"},e.data=n()(e.data)):"delete"!==e.method&&"get"!==e.method&&"head"!==e.method||(e.paramsSerializer=function(e){return c.a.stringify(e,{arrayFormat:"indices"})}),localStorage.token&&(e.headers.Authorization="Bearer "+localStorage.token),e},function(e){return e}),m.interceptors.response.use(function(e){if(-1===e.headers["content-type"].indexOf("json"))return e;var t=void 0;if("arraybuffer"===e.request.responseType&&"[object ArrayBuffer]"===e.data.toString()){var n=i.from(e.data).toString("utf8");t=JSON.parse(n)}else t=e.data;if(t){if(t.data&&(t.data.token&&(localStorage.token=t.data.token),t.data.refreshToken&&(localStorage.refreshToken=t.data.refreshToken)),t.url)return void(top.location=t.url);if(200!==t.code)return console.log(t),a.a.reject(new p(t.message))}return e},function(e){if(console.log(e.response.headers),401===e.response.status){if(-1!==e.response.headers["content-type"].indexOf("json")&&e.response.data.url)return void(top.location=e.response.data.url);if(e.response.headers["token-expired"]&&localStorage.token&&localStorage.refreshToken){console.log("Refresh Token");var t={token:localStorage.token,refreshToken:localStorage.refreshToken};return localStorage.removeItem("token"),localStorage.removeItem("refreshToken"),m.post("/admin/refreshToken",t),a.a.reject(new p("登录超时，自动登录中......",h,e))}}return a.a.reject(new p(e.message,h,e))}),g.a={install:function(e,t){e.httpClient=m,e.prototype.$httpClient=m}}}).call(g,C("EuP9").Buffer)},"6E37":function(e,t,n){"use strict";var i=n("BO1k"),m=n.n(i),a=n("VsUZ");t.a={data:function(){return{isLoading:!1,page:{list:null,totalItemCount:null,totalPageCount:null},searchCriteriaForm:{keyword:null,toUserId:null,creationTime:null,creationTimeBegin:null,creationTimeEnd:null,isReaded:!1,pagingInfo:{pageNumber:1,pageSize:20,isExcludeMetaData:!1,sortInfo:{sort:"NotificationId",sortDir:"DESC"}}},isReadedNumber:1,selection:null,deleteOneActive:null,deleteOneConfirmDialogVisible:!1,deleteMultipleConfirmDialogVisible:!1,readMultipleConfirmDialogVisible:!1,editActive:null,mainFormDialogVisible:!1,mainForm:{notificationId:null,title:null,message:null},mainFormRules:{title:[{required:!0,message:"请输入标题",trigger:"blur"},{max:100,message:"最多支持100个字符",trigger:"blur"}],message:[{required:!0,message:"请输入消息",trigger:"blur"},{max:1e3,message:"最多支持1000个字符",trigger:"blur"}]}}},mounted:function(){this.getPage()},computed:{mainTableEmptyText:function(){return this.isLoading?"加载中...":"暂无数据"}},watch:{},methods:{getPage:function(){var t=this;this.isLoading=!0;var e=this.searchCriteriaForm;a.a.getNotifications(e).then(function(e){t.isLoading=!1,t.page=e.data.data},function(e){t.isLoading=!1,t.$message.error(e.message)})},handlePaginationSizeChange:function(e){this.searchCriteriaForm.pagingInfo.pageSize=e,this.searchCriteriaForm.pagingInfo.pageNumber=1,this.getPage()},handlePaginationCurrentChange:function(e){this.searchCriteriaForm.pagingInfo.pageNumber=e,this.getPage()},handleSearchAll:function(){this.searchCriteriaForm.pagingInfo.pageNumber=1,this.searchCriteriaForm.keyword=null,this.searchCriteriaForm.creationTimeBegin=null,this.searchCriteriaForm.creationTimeEnd=null,this.getPage()},handleSearch:function(){this.searchCriteriaForm.pagingInfo.pageNumber=1,this.searchCriteriaForm.creationTime&&2===this.searchCriteriaForm.creationTime.length&&(this.searchCriteriaForm.creationTimeBegin=this.searchCriteriaForm.creationTime[0],this.searchCriteriaForm.creationTimeEnd=this.searchCriteriaForm.creationTime[1]),this.getPage()},handleIsReadChange:function(e){this.searchCriteriaForm.isReaded=e?2===e:null,this.handleSearch()},handleDeleteOne:function(e){this.deleteOneActive=e,this.deleteOneConfirmDialogVisible=!0},handleDeleteOneSure:function(e){this.deleteOneConfirmDialogVisible=!1,e?this.deleteOne():this.deleteOneActive=null},handleDeleteMultiple:function(){this.selection&&0!==this.selection.length?this.deleteMultipleConfirmDialogVisible=!0:this.$message.warning("请选择要删除的记录")},handleDeleteMultipleSure:function(e){this.deleteMultipleConfirmDialogVisible=!1,e&&this.deleteMultiple()},deleteOne:function(){this.deleteOneActive&&this.delete([this.deleteOneActive.notificationId])},deleteMultiple:function(){this.delete(this.selection.map(function(e){return e.notificationId}))},delete:function(e){var t=this;if(e&&0!==e.length){var n={notificationIds:e};this.isLoading=!0,a.a.deleteNotifications(n).then(function(e){t.isLoading=!1,t.deleteOneActive=null,t.getPage()},function(e){t.isLoading=!1,t.$message.error(e.message)})}},handleReadOne:function(e){this.read([e.notificationId])},handleReadMultiple:function(){this.selection&&0!==this.selection.length?this.readMultipleConfirmDialogVisible=!0:this.$message.warning("请选择要设置为已读的记录")},handleReadMultipleSure:function(e){this.readMultipleConfirmDialogVisible=!1,e&&this.readMultiple()},readMultiple:function(){this.read(this.selection.map(function(e){return e.notificationId}))},read:function(h){var p=this;if(h&&0!==h.length){var e={notificationIds:h};a.a.readNotifications(e).then(function(e){var t=!0,n=!1,i=void 0;try{for(var a,r=m()(p.page.list);!(t=(a=r.next()).done);t=!0){var o=a.value,l=!0,s=!1,u=void 0;try{for(var c,d=m()(h);!(l=(c=d.next()).done);l=!0){var f=c.value;o.notificationId!==f||(o.readTime=new Date)}}catch(e){s=!0,u=e}finally{try{!l&&d.return&&d.return()}finally{if(s)throw u}}}}catch(e){n=!0,i=e}finally{try{!t&&r.return&&r.return()}finally{if(n)throw i}}},function(e){p.$message.error(e.message)})}},resetForm:function(e){this.$refs[e].resetFields()},clearValidate:function(e){this.$refs[e].clearValidate()},handleSortChange:function(e){this.searchCriteriaForm.pagingInfo.sortInfo.sort=e.prop,this.searchCriteriaForm.pagingInfo.sortInfo.sortDir="descending"===e.order?"DESC":"ASC",this.searchCriteriaForm.pagingInfo.pageNumber=1,this.getPage()},handleSelectionChange:function(e){this.selection=e},handleRowClick:function(e,t,n){"el-table_1_column_2"!==n.id&&this.$refs.mainTable.toggleRowExpansion(e)},handleExpandChange:function(e,t){console.log("handleExpandChange",e,t),e.readTime||this.handleReadOne(e)}}}},"8GiD":function(e,t,n){"use strict";var i=n("6E37"),a=n("PZI4");function r(e){n("Yl/W")}var o=n("VU/8")(i.a,a.a,!1,r,null,null);t.a=o.exports},PZI4:function(e,t,n){"use strict";var i={render:function(){var n=this,e=n.$createElement,i=n._self._c||e;return i("el-container",{directives:[{name:"loading",rawName:"v-loading.fullscreen.lock",value:n.isLoading,expression:"isLoading",modifiers:{fullscreen:!0,lock:!0}}]},[i("el-header",{staticClass:"header"},[i("el-breadcrumb",{staticClass:"breadcrumb",attrs:{"separator-class":"el-icon-arrow-right"}},[i("el-breadcrumb-item",[n._v("通知中心")])],1)],1),n._v(" "),i("el-main",{staticClass:"main"},[i("el-form",{ref:"searchCriteriaForm",staticClass:"searchCriteriaForm",attrs:{model:n.searchCriteriaForm,inline:""}},[i("el-row",[i("el-form-item",[i("el-radio-group",{on:{change:n.handleIsReadChange},model:{value:n.isReadedNumber,callback:function(e){n.isReadedNumber=e},expression:"isReadedNumber"}},[i("el-radio-button",{attrs:{label:1}},[n._v("未读")]),n._v(" "),i("el-radio-button",{attrs:{label:2}},[n._v("已读")]),n._v(" "),i("el-radio-button",[n._v("全部")])],1)],1),n._v(" "),i("el-form-item",[i("el-input",{staticClass:"filterText",attrs:{placeholder:"关键字(标题)",clearable:""},model:{value:n.searchCriteriaForm.keyword,callback:function(e){n.$set(n.searchCriteriaForm,"keyword",e)},expression:"searchCriteriaForm.keyword"}})],1),n._v(" "),i("el-form-item",[i("el-date-picker",{attrs:{format:"yyyy-MM-dd","value-format":"yyyy-MM-dd",type:"daterange","range-separator":"至","start-placeholder":"创建日期开始","end-placeholder":"创建日期结束"},model:{value:n.searchCriteriaForm.creationTime,callback:function(e){n.$set(n.searchCriteriaForm,"creationTime",e)},expression:"searchCriteriaForm.creationTime"}})],1),n._v(" "),i("el-form-item",[i("el-button-group",[i("el-button",{attrs:{type:"primary",icon:"el-icon-search"},on:{click:function(e){return n.handleSearch()}}},[n._v("搜索")]),n._v(" "),i("el-button",{attrs:{type:"primary",icon:"el-icon-search"},on:{click:function(e){return n.handleSearchAll()}}},[n._v("全部")])],1)],1)],1),n._v(" "),i("el-row",[i("el-form-item",[i("el-button-group",[i("el-button",{attrs:{plain:"",icon:"el-icon-view"},on:{click:function(e){return n.handleReadMultiple()}}},[n._v("设置已读")]),n._v(" "),i("el-button",{attrs:{plain:"",icon:"el-icon-remove-outline"},on:{click:function(e){return n.handleDeleteMultiple()}}},[n._v("删除通知")])],1)],1)],1)],1),n._v(" "),i("el-row",[i("el-table",{ref:"mainTable",staticStyle:{width:"100%"},attrs:{data:n.page.list,"empty-text":n.mainTableEmptyText},on:{"selection-change":n.handleSelectionChange,"expand-change":n.handleExpandChange,"row-click":n.handleRowClick,"sort-change":n.handleSortChange}},[i("el-table-column",{attrs:{type:"selection",width:"56"}}),n._v(" "),i("el-table-column",{attrs:{type:"expand",label:"查看"},scopedSlots:n._u([{key:"default",fn:function(e){return[i("div",{domProps:{innerHTML:n._s(e.row.message)}})]}}])}),n._v(" "),i("el-table-column",{attrs:{prop:"notificationId",label:"#",width:"60",sortable:"custom"}}),n._v(" "),i("el-table-column",{attrs:{prop:"title",label:"标题"}}),n._v(" "),i("el-table-column",{attrs:{label:"已读",width:"100"},scopedSlots:n._u([{key:"default",fn:function(e){return[i("span",[n._v(n._s(e.row.readTime?"√":""))])]}}])}),n._v(" "),i("el-table-column",{attrs:{label:"来自",width:"100"},scopedSlots:n._u([{key:"default",fn:function(e){return[i("span",[n._v(n._s(e.row.fromUser?e.row.fromUser.displayName:"系统"))])]}}])}),n._v(" "),i("el-table-column",{attrs:{label:"送至",width:"100"},scopedSlots:n._u([{key:"default",fn:function(e){return[i("span",[n._v(n._s(e.row.toUser?e.row.toUser.displayName:"全部"))])]}}])}),n._v(" "),i("el-table-column",{attrs:{prop:"creationTime",label:"创建时间",width:"160"}}),n._v(" "),i("el-table-column",{attrs:{align:"center",width:"42"},scopedSlots:n._u([{key:"default",fn:function(t){return[i("el-button",{attrs:{type:"text",size:"small",icon:"el-icon-delete"},on:{click:function(e){return e.stopPropagation(),n.handleDeleteOne(t.row)}}})]}}])})],1)],1),n._v(" "),i("el-dialog",{attrs:{title:"提示",visible:n.deleteOneConfirmDialogVisible,width:"320px",center:""},on:{"update:visible":function(e){n.deleteOneConfirmDialogVisible=e}}},[i("span",[n._v("确定要删除该通知吗？")]),n._v(" "),i("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[i("el-button",{on:{click:function(e){return n.handleDeleteOneSure(!1)}}},[n._v("取 消")]),n._v(" "),i("el-button",{attrs:{type:"primary"},on:{click:function(e){return n.handleDeleteOneSure(!0)}}},[n._v("确 定")])],1)]),n._v(" "),i("el-dialog",{attrs:{title:"提示",visible:n.deleteMultipleConfirmDialogVisible,width:"320px",center:""},on:{"update:visible":function(e){n.deleteMultipleConfirmDialogVisible=e}}},[i("span",[n._v("确定要将选择的通知删除吗？")]),n._v(" "),i("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[i("el-button",{on:{click:function(e){return n.handleDeleteMultipleSure(!1)}}},[n._v("取 消")]),n._v(" "),i("el-button",{attrs:{type:"primary"},on:{click:function(e){return n.handleDeleteMultipleSure(!0)}}},[n._v("确 定")])],1)]),n._v(" "),i("el-dialog",{attrs:{title:"提示",visible:n.readMultipleConfirmDialogVisible,width:"320px",center:""},on:{"update:visible":function(e){n.readMultipleConfirmDialogVisible=e}}},[i("span",[n._v("确定要将选择的通知设置为已读吗？")]),n._v(" "),i("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[i("el-button",{on:{click:function(e){return n.handleReadMultipleSure(!1)}}},[n._v("取 消")]),n._v(" "),i("el-button",{attrs:{type:"primary"},on:{click:function(e){return n.handleReadMultipleSure(!0)}}},[n._v("确 定")])],1)])],1),n._v(" "),i("el-footer",{staticClass:"footer"},[n.page.totalItemCount?i("el-pagination",{attrs:{"current-page":n.searchCriteriaForm.pagingInfo.pageNumber,"page-sizes":[20,50,100,200,400],"page-size":n.searchCriteriaForm.pagingInfo.pageSize,layout:"total, sizes, prev, pager, next, jumper",total:n.page.totalItemCount},on:{"size-change":n.handlePaginationSizeChange,"current-change":n.handlePaginationCurrentChange}}):n._e()],1)],1)},staticRenderFns:[]};t.a=i},VsUZ:function(e,t,n){"use strict";var i=n("7+uW");t.a={login:function(e){return i.default.httpClient.post("/admin/login",e)},refreshToken:function(e){return i.default.httpClient.post("/admin/refreshToken",e)},logout:function(){return i.default.httpClient.post("/admin/logout")},getProfile:function(){return i.default.httpClient.get("/admin/getProfile")},changeProfile:function(e){return i.default.httpClient.post("/admin/changeProfile",e)},changeAvatar:function(e){return i.default.uploadHttpClient.post("/admin/ChangeAvatar",e)},changeLogo:function(e){return i.default.uploadHttpClient.post("/admin/ChangeLogo",e)},changePassword:function(e){return i.default.httpClient.post("/admin/changePassword",e)},getMenus:function(){return i.default.httpClient.get("/admin/getMenus")},getBulletin:function(){return i.default.httpClient.get("/admin/getBulletin")},editBulletin:function(e){return i.default.httpClient.post("/admin/editBulletin",e)},getModuleMetaDatas:function(){return i.default.httpClient.get("/admin/getModuleMetaDatas")},extractModuleMetaDatas:function(){return i.default.httpClient.get("/admin/extractModuleMetaDatas")},clearModulePermissions:function(){return i.default.httpClient.get("/admin/clearModulePermissions")},getRoleList:function(){return i.default.httpClient.get("/admin/getRoleList")},addRole:function(e){return i.default.httpClient.post("/admin/addRole",e)},editRole:function(e){return i.default.httpClient.post("/admin/editRole",e)},removeRole:function(e){return i.default.httpClient.post("/admin/removeRole",e)},moveRole:function(e){return i.default.httpClient.post("/admin/moveRole",e)},saveRoleName:function(e){return i.default.httpClient.post("/admin/saveRoleName",e)},getGroupTree:function(){return i.default.httpClient.get("/admin/getGroupTree")},addGroup:function(e){return i.default.httpClient.post("/admin/addGroup",e)},editGroup:function(e){return i.default.httpClient.post("/admin/editGroup",e)},removeGroup:function(e){return i.default.httpClient.post("/admin/removeGroup",e)},moveGroup:function(e){return i.default.httpClient.post("/admin/moveGroup",e)},getUserPage:function(e){return i.default.httpClient.post("/admin/getUserPage",e)},addUser:function(e){return i.default.httpClient.post("/admin/addUser",e)},editUser:function(e){return i.default.httpClient.post("/admin/editUser",e)},removeUser:function(e){return i.default.httpClient.post("/admin/removeUser",e)},getUserStatuList:function(){return i.default.httpClient.get("/admin/getUserStatuList")},changeUserAvatar:function(e){return i.default.uploadHttpClient.post("/admin/ChangeUserAvatar",e)},changeUserLogo:function(e){return i.default.uploadHttpClient.post("/admin/ChangeUserLogo",e)},getNotificationsForManager:function(e){return i.default.httpClient.post("/admin/getNotificationsForManager",e)},addNotification:function(e){return i.default.httpClient.post("/admin/addNotification",e)},editNotification:function(e){return i.default.httpClient.post("/admin/editNotification",e)},removeNotification:function(e){return i.default.httpClient.post("/admin/removeNotification",e)},getNotifications:function(e){return i.default.httpClient.post("/admin/getNotifications",e)},readNotifications:function(e){return i.default.httpClient.post("/admin/readNotifications",e)},deleteNotifications:function(e){return i.default.httpClient.post("/admin/deleteNotifications",e)},getNewestNotification:function(e){return i.default.httpClient.post("/admin/getNewestNotification",e)},getGroupList:function(){return i.default.httpClient.get("/admin/getGroupList")},getRoleBaseList:function(){return i.default.httpClient.get("/admin/getRoleBaseList")},getPermissionTree:function(){return i.default.httpClient.get("/admin/getPermissionTree")},callDirectly:function(e){return i.default.httpClient.get(e)},download:function(e,t){return i.default.httpClient.post(e,t,{responseType:"arraybuffer"})}}},"Yl/W":function(e,t){},bzuE:function(e,t,n){"use strict";n.d(t,"a",function(){return i}),n.d(t,"b",function(){return a}),n.d(t,"c",function(){return r});var i="/api",a="",r=""},mQcG:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=n("tvR6"),a=(n.n(i),n("qBF2")),r=n.n(a),o=n("7+uW"),l=n("/rEA"),s=n("uN2V"),u=(n.n(s),n("8GiD"));o.default.config.productionTip=!1,o.default.use(l.a),o.default.use(r.a,{size:"mini"}),new o.default({el:"#app",render:function(e){return e(u.a)}})},tvR6:function(e,t){},uN2V:function(e,t){}},["mQcG"]);
//# sourceMappingURL=notification.js.map