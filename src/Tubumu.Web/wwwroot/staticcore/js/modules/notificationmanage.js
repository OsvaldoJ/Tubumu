webpackJsonp([2],{"+cgv":function(e,t){},"/rEA":function(e,t,i){"use strict";(function(e){function n(e,t,i){this.name="ApiError",this.message=e||"Default Message",this.errorType=t||p.Default,this.innerError=i,this.stack=(new Error).stack}var o=i("//Fk"),r=i.n(o),a=i("mvHQ"),l=i.n(a),s=i("OvRC"),u=i.n(s),c=i("mtWM"),d=i.n(c),f=i("mw3O"),m=i.n(f),h=i("bzuE"),p={Default:"default",Sysetem:"sysetem"};(n.prototype=u()(Error.prototype)).constructor=n;var g=d.a.create({baseURL:h.a,timeout:2e4,responseType:"json",withCredentials:!0});g.interceptors.request.use(function(e){return"post"===e.method||"put"===e.method||"patch"===e.method?(e.headers={"Content-Type":"application/json; charset=UTF-8"},e.data=l()(e.data)):"delete"!==e.method&&"get"!==e.method&&"head"!==e.method||(e.paramsSerializer=function(e){return m.a.stringify(e,{arrayFormat:"indices"})}),localStorage.token&&(e.headers.Authorization="Bearer "+localStorage.token),e},function(e){return e}),g.interceptors.response.use(function(t){if(-1===t.headers["content-type"].indexOf("json"))return t;var i=void 0;if("arraybuffer"===t.request.responseType&&"[object ArrayBuffer]"===t.data.toString()){var o=e.from(t.data).toString("utf8");i=JSON.parse(o)}else i=t.data;if(i){if(i.data&&(i.data.token&&(localStorage.token=i.data.token),i.data.refreshToken&&(localStorage.refreshToken=i.data.refreshToken)),i.url)return void(top.location=i.url);if(200!==i.code)return console.log(i),r.a.reject(new n(i.message))}return t},function(e){if(console.log(e.response.headers),401===e.response.status){if(-1!==e.response.headers["content-type"].indexOf("json")&&e.response.data.url)return void(top.location=e.response.data.url);if(e.response.headers["token-expired"]&&localStorage.token&&localStorage.refreshToken){console.log("Refresh Token");var t={token:localStorage.token,refreshToken:localStorage.refreshToken};return localStorage.removeItem("token"),localStorage.removeItem("refreshToken"),g.post("/admin/refreshToken",t),r.a.reject(new n("登录超时，自动登录中......",p.Sysetem,e))}}return r.a.reject(new n(e.message,p.Sysetem,e))}),t.a={install:function(e){arguments.length>1&&void 0!==arguments[1]&&arguments[1];e.httpClient=g,e.prototype.$httpClient=g}}}).call(t,i("EuP9").Buffer)},"3f40":function(e,t){},"3uKa":function(e,t){},"4qOc":function(e,t){},"5lsP":function(e,t){},CbDO:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=i("tvR6"),o=(i.n(n),i("qBF2")),r=i.n(o),a=i("7+uW"),l=i("/rEA"),s=i("/7iZ"),u=i.n(s),c=i("uN2V"),d=(i.n(c),i("q+7M"));a.default.config.productionTip=!1,a.default.use(l.a),a.default.use(u.a),a.default.use(r.a,{size:"mini"}),new a.default({el:"#app",render:function(e){return e(d.a)}})},MUOT:function(e,t,i){"use strict";var n=i("VsUZ");t.a={data:function(){return{isLoading:!1,editorOption:{placeholder:"请输入消息"},page:{list:null,totalItemCount:null,totalPageCount:null},searchCriteriaForm:{keyword:null,toUserId:null,creationTime:null,creationTimeBegin:null,creationTimeEnd:null,pagingInfo:{pageNumber:1,pageSize:20,isExcludeMetaData:!1,sortInfo:{sort:"NotificationId",sortDir:"DESC"}}},removeActive:null,editActive:null,mainFormDialogVisible:!1,mainForm:{notificationId:null,title:null,message:null},mainFormRules:{title:[{required:!0,message:"请输入标题",trigger:"blur"},{max:100,message:"最多支持100个字符",trigger:"blur"}],message:[{required:!0,message:"请输入消息",trigger:"blur"},{max:1e3,message:"最多支持1000个字符",trigger:"blur"}]}}},mounted:function(){this.getPage()},computed:{mainTableEmptyText:function(){return this.isLoading?"加载中...":"暂无数据"}},watch:{},methods:{getPage:function(){var e=this;this.isLoading=!0;var t=this.searchCriteriaForm;n.a.getNotificationsForManager(t).then(function(t){e.isLoading=!1,e.page=t.data.data},function(t){e.isLoading=!1,e.$message.error(t.message)})},handlePaginationSizeChange:function(e){this.searchCriteriaForm.pageInfo.pageSize=e,this.searchCriteriaForm.pageInfo.pageNumber=1,this.getPage()},handlePaginationCurrentChange:function(e){this.searchCriteriaForm.pageInfo.pageNumber=e,this.getPage()},handleSearchAll:function(){this.searchCriteriaForm.pageInfo.pageNumber=1,this.searchCriteriaForm.keyword=null,this.getPage()},handleSearch:function(){this.searchCriteriaForm.pageInfo.pageNumber=1,this.searchCriteriaForm.creationTime&&2===this.searchCriteriaForm.creationTime.length&&(this.searchCriteriaForm.creationTimeBegin=this.searchCriteriaForm.creationTime[0],this.searchCriteriaForm.creationTimeEnd=this.searchCriteriaForm.creationTime[1]),this.getPage()},handleAdd:function(){var e=this;this.editActive=null,this.mainFormDialogVisible=!0,this.mainForm.notificationId=null,this.mainForm.title=null,this.mainForm.message=null,this.$nextTick(function(){e.clearValidate("mainForm")})},handleEdit:function(e){var t=this;console.log("handleEdit",e),this.editActive=e,this.mainFormDialogVisible=!0,this.mainForm.notificationId=e.notificationId,this.mainForm.title=e.title,this.mainForm.message=e.message,this.$nextTick(function(){t.clearValidate("mainForm")})},handleMainFormSure:function(e){console.log("handleMainFormSure",e),e?this.editActive?this.edit():this.add():this.mainFormDialogVisible=!1},handleRemove:function(e){var t=this;this.removeActive=e,this.$confirm("删除该通知后，相关的数据也将被删除。是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){t.remove()}).catch(function(){t.removeActive=null})},add:function(){var e=this;this.$refs.mainForm.validate(function(t){if(!t)return!1;e.isLoading=!0;var i=e.mainForm;n.a.addNotification(i).then(function(t){e.isLoading=!1,e.mainFormDialogVisible=!1,e.getPage()},function(t){e.isLoading=!1,e.$message.error(t.message)})})},edit:function(){var e=this;this.editActive?this.$refs.mainForm.validate(function(t){if(!t)return!1;e.isLoading=!0;var i=e.mainForm;n.a.editNotification(i).then(function(t){e.isLoading=!1,e.editActive=null,e.mainFormDialogVisible=!1,e.getPage()},function(t){e.isLoading=!1,e.$message.error(t.message)})}):this.$message.error("异常：无编辑目标")},remove:function(){var e=this;if(this.removeActive){var t={notificationId:this.removeActive.notificationId};this.isLoading=!0,n.a.removeNotification(t).then(function(t){e.isLoading=!1,e.removeActive=null,e.getPage()},function(t){e.isLoading=!1,e.$message.error(t.message)})}},resetForm:function(e){this.$refs[e].resetFields()},clearValidate:function(e){this.$refs[e].clearValidate()},handleRowClick:function(e,t,i){"el-table_1_column_1"!==i.id&&this.$refs.mainTable.toggleRowExpansion(e)},handleSortChange:function(e){this.searchCriteriaForm.pageInfo.sortInfo.sort=e.prop,this.searchCriteriaForm.pageInfo.sortInfo.sortDir="descending"===e.order?"DESC":"ASC",this.searchCriteriaForm.pageInfo.pageNumber=1,this.getPage()}}}},V84S:function(e,t,i){"use strict";i("4qOc"),i("+cgv"),i("3f40"),window.Quill||(window.Quill=i("yPE/")),t.a={name:"quill-editor",data:function(){return{_content:"",defaultModules:{toolbar:[["bold","italic","underline","strike"],["blockquote","code-block"],[{header:1},{header:2}],[{list:"ordered"},{list:"bullet"}],[{script:"sub"},{script:"super"}],[{indent:"-1"},{indent:"+1"}],[{direction:"rtl"}],[{size:["small",!1,"large","huge"]}],[{header:[1,2,3,4,5,6,!1]}],[{color:[]},{background:[]}],[{font:[]}],[{align:[]}],["clean"],["link","image","video"]]}}},props:{content:String,value:String,disabled:Boolean,options:{type:Object,required:!1,default:function(){return{}}}},mounted:function(){this.initialize()},beforeDestroy:function(){this.quill=null},methods:{initialize:function(){if(this.$el){var e=this;e.options.theme=e.options.theme||"snow",e.options.boundary=e.options.boundary||document.body,e.options.modules=e.options.modules||e.defaultModules,e.options.modules.toolbar=void 0!==e.options.modules.toolbar?e.options.modules.toolbar:e.defaultModules.toolbar,e.options.placeholder=e.options.placeholder||"Insert text here ...",e.options.readOnly=void 0!==e.options.readOnly&&e.options.readOnly,e.quill=new Quill(e.$refs.editor,e.options),(e.value||e.content)&&e.quill.pasteHTML(e.value||e.content),e.quill.on("selection-change",function(t){t?e.$emit("focus",e.quill):e.$emit("blur",e.quill)}),e.quill.on("text-change",function(t,i,n){var o=e.$refs.editor.children[0].innerHTML,r=e.quill.getText();"<p><br></p>"===o&&(o=""),e._content=o,e.$emit("input",e._content),e.$emit("change",{editor:e.quill,html:o,text:r})}),this.disabled&&this.quill.enable(!1),e.$emit("ready",e.quill)}}},watch:{content:function(e,t){this.quill&&(e&&e!==this._content?(this._content=e,this.quill.pasteHTML(e)):e||this.quill.setText(""))},value:function(e,t){this.quill&&(e&&e!==this._content?(this._content=e,this.quill.pasteHTML(e)):e||this.quill.setText(""))},disabled:function(e,t){this.quill&&this.quill.enable(!e)}}}},VsUZ:function(e,t,i){"use strict";var n=i("7+uW");t.a={login:function(e){return n.default.httpClient.post("/admin/login",e)},refreshToken:function(e){return n.default.httpClient.post("/admin/refreshToken",e)},logout:function(){return n.default.httpClient.post("/admin/logout")},getProfile:function(){return n.default.httpClient.get("/admin/getProfile")},changeProfile:function(e){return n.default.httpClient.post("/admin/changeProfile",e)},changeAvatar:function(e){return n.default.uploadHttpClient.post("/admin/ChangeAvatar",e)},changeLogo:function(e){return n.default.uploadHttpClient.post("/admin/ChangeLogo",e)},changePassword:function(e){return n.default.httpClient.post("/admin/changePassword",e)},getMenus:function(){return n.default.httpClient.get("/admin/getMenus")},getBulletin:function(){return n.default.httpClient.get("/admin/getBulletin")},editBulletin:function(e){return n.default.httpClient.post("/admin/editBulletin",e)},getModuleMetaDatas:function(){return n.default.httpClient.get("/admin/getModuleMetaDatas")},extractModuleMetaDatas:function(){return n.default.httpClient.get("/admin/extractModuleMetaDatas")},clearModulePermissions:function(){return n.default.httpClient.get("/admin/clearModulePermissions")},getRoleList:function(){return n.default.httpClient.get("/admin/getRoleList")},addRole:function(e){return n.default.httpClient.post("/admin/addRole",e)},editRole:function(e){return n.default.httpClient.post("/admin/editRole",e)},removeRole:function(e){return n.default.httpClient.post("/admin/removeRole",e)},moveRole:function(e){return n.default.httpClient.post("/admin/moveRole",e)},saveRoleName:function(e){return n.default.httpClient.post("/admin/saveRoleName",e)},getGroupTree:function(){return n.default.httpClient.get("/admin/getGroupTree")},addGroup:function(e){return n.default.httpClient.post("/admin/addGroup",e)},editGroup:function(e){return n.default.httpClient.post("/admin/editGroup",e)},removeGroup:function(e){return n.default.httpClient.post("/admin/removeGroup",e)},moveGroup:function(e){return n.default.httpClient.post("/admin/moveGroup",e)},getUserPage:function(e){return n.default.httpClient.post("/admin/getUserPage",e)},addUser:function(e){return n.default.httpClient.post("/admin/addUser",e)},editUser:function(e){return n.default.httpClient.post("/admin/editUser",e)},removeUser:function(e){return n.default.httpClient.post("/admin/removeUser",e)},getUserStatuList:function(){return n.default.httpClient.get("/admin/getUserStatuList")},changeUserAvatar:function(e){return n.default.uploadHttpClient.post("/admin/ChangeUserAvatar",e)},changeUserLogo:function(e){return n.default.uploadHttpClient.post("/admin/ChangeUserLogo",e)},getNotificationsForManager:function(e){return n.default.httpClient.post("/admin/getNotificationsForManager",e)},addNotification:function(e){return n.default.httpClient.post("/admin/addNotification",e)},editNotification:function(e){return n.default.httpClient.post("/admin/editNotification",e)},removeNotification:function(e){return n.default.httpClient.post("/admin/removeNotification",e)},getNotifications:function(e){return n.default.httpClient.post("/admin/getNotifications",e)},readNotifications:function(e){return n.default.httpClient.post("/admin/readNotifications",e)},deleteNotifications:function(e){return n.default.httpClient.post("/admin/deleteNotifications",e)},getNewestNotification:function(e){return n.default.httpClient.post("/admin/getNewestNotification",e)},getGroupList:function(){return n.default.httpClient.get("/admin/getGroupList")},getRoleBaseList:function(){return n.default.httpClient.get("/admin/getRoleBaseList")},getPermissionTree:function(){return n.default.httpClient.get("/admin/getPermissionTree")},callDirectly:function(e){return n.default.httpClient.get(e)},download:function(e,t){return n.default.httpClient.post(e,t,{responseType:"arraybuffer"})}}},Wkky:function(e,t,i){"use strict";var n={render:function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("el-container",{directives:[{name:"loading",rawName:"v-loading.fullscreen.lock",value:e.isLoading,expression:"isLoading",modifiers:{fullscreen:!0,lock:!0}}]},[i("el-header",{staticClass:"header"},[i("el-breadcrumb",{staticClass:"breadcrumb",attrs:{"separator-class":"el-icon-arrow-right"}},[i("el-breadcrumb-item",[e._v("系统管理")]),e._v(" "),i("el-breadcrumb-item",[e._v("通知管理")])],1)],1),e._v(" "),i("el-main",{staticClass:"main"},[i("el-form",{ref:"searchCriteriaForm",staticClass:"searchCriteriaForm",attrs:{model:e.searchCriteriaForm,inline:""}},[i("el-row",[i("el-form-item",[i("el-input",{staticClass:"filterText",attrs:{placeholder:"关键字(标题)",clearable:""},model:{value:e.searchCriteriaForm.keyword,callback:function(t){e.$set(e.searchCriteriaForm,"keyword",t)},expression:"searchCriteriaForm.keyword"}})],1),e._v(" "),i("el-form-item",[i("el-date-picker",{attrs:{"value-format":"yyyy-MM-dd",type:"daterange","range-separator":"至","start-placeholder":"创建日期开始","end-placeholder":"创建日期结束"},model:{value:e.searchCriteriaForm.creationTime,callback:function(t){e.$set(e.searchCriteriaForm,"creationTime",t)},expression:"searchCriteriaForm.creationTime"}})],1),e._v(" "),i("el-form-item",[i("el-button-group",[i("el-button",{attrs:{type:"primary",icon:"el-icon-search"},on:{click:function(t){return e.handleSearch()}}},[e._v("搜索")]),e._v(" "),i("el-button",{attrs:{type:"primary",icon:"el-icon-search"},on:{click:function(t){return e.handleSearchAll()}}},[e._v("全部")])],1),e._v(" "),i("el-button",{attrs:{type:"primary",icon:"el-icon-circle-plus-outline"},on:{click:function(t){return e.handleAdd()}}},[e._v("添加")])],1)],1)],1),e._v(" "),i("el-row",[i("el-table",{ref:"mainTable",staticStyle:{width:"100%"},attrs:{data:e.page.list,"empty-text":e.mainTableEmptyText},on:{"row-click":e.handleRowClick,"sort-change":e.handleSortChange}},[i("el-table-column",{attrs:{type:"expand",label:"查看"},scopedSlots:e._u([{key:"default",fn:function(t){return[i("div",{domProps:{innerHTML:e._s(t.row.message)}})]}}])}),e._v(" "),i("el-table-column",{attrs:{prop:"notificationId",label:"#",width:"60",sortable:"custom"}}),e._v(" "),i("el-table-column",{attrs:{prop:"title",label:"标题"}}),e._v(" "),e.searchCriteriaForm.toUserId?i("el-table-column",{attrs:{label:"已读",width:"100"},scopedSlots:e._u([{key:"default",fn:function(t){return[i("span",[e._v(e._s(t.row.readTime?"√":""))])]}}],null,!1,82334014)}):e._e(),e._v(" "),i("el-table-column",{attrs:{label:"来自",width:"100"},scopedSlots:e._u([{key:"default",fn:function(t){return[i("span",[e._v(e._s(t.row.fromUser?t.row.fromUser.displayName:"系统"))])]}}])}),e._v(" "),i("el-table-column",{attrs:{label:"送至",width:"100"},scopedSlots:e._u([{key:"default",fn:function(t){return[i("span",[e._v(e._s(t.row.toUser?t.row.toUser.displayName:"全部"))])]}}])}),e._v(" "),e.searchCriteriaForm.toUserId?i("el-table-column",{attrs:{label:"已删",width:"100"},scopedSlots:e._u([{key:"default",fn:function(t){return[i("span",[e._v(e._s(t.row.deleteTime?"√":""))])]}}],null,!1,3168949717)}):e._e(),e._v(" "),i("el-table-column",{attrs:{prop:"creationTime",label:"创建时间",width:"160"}}),e._v(" "),i("el-table-column",{attrs:{align:"center",fixed:"right",width:"84"},scopedSlots:e._u([{key:"default",fn:function(t){return[i("el-button",{attrs:{type:"text",size:"small",icon:"el-icon-edit"},on:{click:function(i){return i.stopPropagation(),e.handleEdit(t.row)}}}),e._v(" "),i("el-button",{attrs:{type:"text",size:"small",icon:"el-icon-delete"},on:{click:function(i){return i.stopPropagation(),e.handleRemove(t.row)}}})]}}])})],1)],1),e._v(" "),i("el-dialog",{attrs:{visible:e.mainFormDialogVisible,"close-on-click-modal":!1,width:"780px"},on:{"update:visible":function(t){e.mainFormDialogVisible=t}},nativeOn:{submit:function(e){e.preventDefault()}}},[i("span",{attrs:{slot:"title"},slot:"title"},[e._v("\r\n          "+e._s(e.editActive?"编辑":"添加")+"\r\n        ")]),e._v(" "),i("el-form",{ref:"mainForm",attrs:{model:e.mainForm,rules:e.mainFormRules,"label-position":"right","label-width":"120px"}},[i("el-form-item",{attrs:{label:"标题",prop:"title",placeholder:"请输入标题"}},[i("el-input",{attrs:{type:"text"},model:{value:e.mainForm.title,callback:function(t){e.$set(e.mainForm,"title",t)},expression:"mainForm.title"}})],1),e._v(" "),i("el-form-item",{attrs:{label:"消息",prop:"message",placeholder:"请输入简称"}},[i("quill-editor",{ref:"messageEditor",attrs:{options:e.editorOption},model:{value:e.mainForm.message,callback:function(t){e.$set(e.mainForm,"message",t)},expression:"mainForm.message"}})],1)],1),e._v(" "),i("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[i("el-button",{on:{click:function(t){return e.handleMainFormSure(!1)}}},[e._v("取 消")]),e._v(" "),i("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.handleMainFormSure(!0)}}},[e._v("确 定")])],1)],1)],1),e._v(" "),i("el-footer",{staticClass:"footer"},[e.page.totalItemCount?i("el-pagination",{attrs:{"current-page":e.searchCriteriaForm.pagingInfo.pageNumber,"page-sizes":[20,50,100,200,400],"page-size":e.searchCriteriaForm.pagingInfo.pageSize,layout:"total, sizes, prev, pager, next, jumper",total:e.page.totalItemCount},on:{"size-change":e.handlePaginationSizeChange,"current-change":e.handlePaginationCurrentChange}}):e._e()],1)],1)},staticRenderFns:[]};t.a=n},bJDK:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=i("V84S"),o=i("gJGC"),r=function(e){i("5lsP")},a=i("VU/8")(n.a,o.a,!1,r,null,null);t.default=a.exports},bzuE:function(e,t,i){"use strict";i.d(t,"a",function(){return n}),i.d(t,"b",function(){return o}),i.d(t,"c",function(){return r});var n="/api",o="",r=""},gJGC:function(e,t,i){"use strict";var n={render:function(){var e=this.$createElement,t=this._self._c||e;return t("div",{staticClass:"quill-editor"},[this._t("toolbar"),this._v(" "),t("div",{ref:"editor"})],2)},staticRenderFns:[]};t.a=n},"q+7M":function(e,t,i){"use strict";var n=i("MUOT"),o=i("Wkky"),r=function(e){i("3uKa")},a=i("VU/8")(n.a,o.a,!1,r,null,null);t.a=a.exports},tvR6:function(e,t){},uN2V:function(e,t){}},["CbDO"]);
//# sourceMappingURL=notificationmanage.js.map