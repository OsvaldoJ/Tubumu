webpackJsonp([2],{"+cgv":function(t,e){},"/rEA":function(t,g,v){"use strict";(function(n){var t=v("//Fk"),o=v.n(t),e=v("mvHQ"),i=v.n(e),r=v("OvRC"),a=v.n(r),l=v("mtWM"),s=v.n(l),u=v("mw3O"),c=v.n(u),d=v("bzuE"),f="default",m="sysetem";function h(t,e,i){this.name="ApiError",this.message=t||"Default Message",this.errorType=e||f,this.innerError=i,this.stack=(new Error).stack}(h.prototype=a()(Error.prototype)).constructor=h;var p=s.a.create({baseURL:d.a,timeout:2e4,responseType:"json",withCredentials:!0});p.interceptors.request.use(function(t){return"post"===t.method||"put"===t.method||"patch"===t.method?(t.headers={"Content-Type":"application/json; charset=UTF-8"},t.data=i()(t.data)):"delete"!==t.method&&"get"!==t.method&&"head"!==t.method||(t.paramsSerializer=function(t){return c.a.stringify(t,{arrayFormat:"indices"})}),localStorage.token&&(t.headers.Authorization="Bearer "+localStorage.token),t},function(t){return t}),p.interceptors.response.use(function(t){if(-1===t.headers["content-type"].indexOf("json"))return t;var e=void 0;if("arraybuffer"===t.request.responseType&&"[object ArrayBuffer]"===t.data.toString()){var i=n.from(t.data).toString("utf8");e=JSON.parse(i)}else e=t.data;if(e){if(e.data&&(e.data.token&&(localStorage.token=e.data.token),e.data.refreshToken&&(localStorage.refreshToken=e.data.refreshToken)),e.url)return void(top.location=e.url);if(200!==e.code)return console.log(e),o.a.reject(new h(e.message))}return t},function(t){if(console.log(t.response.headers),401===t.response.status){if(-1!==t.response.headers["content-type"].indexOf("json")&&t.response.data.url)return void(top.location=t.response.data.url);if(t.response.headers["token-expired"]&&localStorage.token&&localStorage.refreshToken){console.log("Refresh Token");var e={token:localStorage.token,refreshToken:localStorage.refreshToken};return localStorage.removeItem("token"),localStorage.removeItem("refreshToken"),p.post("/admin/refreshToken",e),o.a.reject(new h("登录超时，自动登录中......",m,t))}}return o.a.reject(new h(t.message,m,t))}),g.a={install:function(t,e){t.httpClient=p,t.prototype.$httpClient=p}}}).call(g,v("EuP9").Buffer)},"3f40":function(t,e){},"4qOc":function(t,e){},"5lsP":function(t,e){},"72kH":function(t,e){},"9fPD":function(t,e,i){"use strict";var n={render:function(){var i=this,t=i.$createElement,n=i._self._c||t;return n("el-container",{directives:[{name:"loading",rawName:"v-loading.fullscreen.lock",value:i.isLoading,expression:"isLoading",modifiers:{fullscreen:!0,lock:!0}}]},[n("el-header",{staticClass:"header"},[n("el-breadcrumb",{staticClass:"breadcrumb",attrs:{"separator-class":"el-icon-arrow-right"}},[n("el-breadcrumb-item",[i._v("系统管理")]),i._v(" "),n("el-breadcrumb-item",[i._v("通知管理")])],1)],1),i._v(" "),n("el-main",{staticClass:"main"},[n("el-form",{ref:"searchCriteriaForm",staticClass:"searchCriteriaForm",attrs:{model:i.searchCriteriaForm,inline:""}},[n("el-row",[n("el-form-item",[n("el-input",{staticClass:"filterText",attrs:{placeholder:"关键字(标题)",clearable:""},model:{value:i.searchCriteriaForm.keyword,callback:function(t){i.$set(i.searchCriteriaForm,"keyword",t)},expression:"searchCriteriaForm.keyword"}})],1),i._v(" "),n("el-form-item",[n("el-date-picker",{attrs:{format:"yyyy-MM-dd","value-format":"yyyy-MM-dd",type:"daterange","range-separator":"至","start-placeholder":"创建日期开始","end-placeholder":"创建日期结束"},model:{value:i.searchCriteriaForm.creationTime,callback:function(t){i.$set(i.searchCriteriaForm,"creationTime",t)},expression:"searchCriteriaForm.creationTime"}})],1),i._v(" "),n("el-form-item",[n("el-button-group",[n("el-button",{attrs:{type:"primary",icon:"el-icon-search"},on:{click:function(t){return i.handleSearch()}}},[i._v("搜索")]),i._v(" "),n("el-button",{attrs:{type:"primary",icon:"el-icon-search"},on:{click:function(t){return i.handleSearchAll()}}},[i._v("全部")])],1),i._v(" "),n("el-button",{attrs:{type:"primary",icon:"el-icon-circle-plus-outline"},on:{click:function(t){return i.handleAdd()}}},[i._v("添加")])],1)],1)],1),i._v(" "),n("el-row",[n("el-table",{ref:"mainTable",staticStyle:{width:"100%"},attrs:{data:i.page.list,"empty-text":i.mainTableEmptyText},on:{"row-click":i.handleRowClick,"sort-change":i.handleSortChange}},[n("el-table-column",{attrs:{type:"expand",label:"查看"},scopedSlots:i._u([{key:"default",fn:function(t){return[n("div",{domProps:{innerHTML:i._s(t.row.message)}})]}}])}),i._v(" "),n("el-table-column",{attrs:{prop:"notificationId",label:"#",width:"60",sortable:"custom"}}),i._v(" "),n("el-table-column",{attrs:{prop:"title",label:"标题"}}),i._v(" "),i.searchCriteriaForm.toUserId?n("el-table-column",{attrs:{label:"已读",width:"100"},scopedSlots:i._u([{key:"default",fn:function(t){return[n("span",[i._v(i._s(t.row.readTime?"√":""))])]}}],null,!1,82334014)}):i._e(),i._v(" "),n("el-table-column",{attrs:{label:"来自",width:"100"},scopedSlots:i._u([{key:"default",fn:function(t){return[n("span",[i._v(i._s(t.row.fromUser?t.row.fromUser.displayName:"系统"))])]}}])}),i._v(" "),n("el-table-column",{attrs:{label:"送至",width:"100"},scopedSlots:i._u([{key:"default",fn:function(t){return[n("span",[i._v(i._s(t.row.toUser?t.row.toUser.displayName:"全部"))])]}}])}),i._v(" "),i.searchCriteriaForm.toUserId?n("el-table-column",{attrs:{label:"已删",width:"100"},scopedSlots:i._u([{key:"default",fn:function(t){return[n("span",[i._v(i._s(t.row.deleteTime?"√":""))])]}}],null,!1,3168949717)}):i._e(),i._v(" "),n("el-table-column",{attrs:{prop:"creationTime",label:"创建时间",width:"160"}}),i._v(" "),n("el-table-column",{attrs:{align:"center",fixed:"right",width:"84"},scopedSlots:i._u([{key:"default",fn:function(e){return[n("el-button",{attrs:{type:"text",size:"small",icon:"el-icon-edit"},on:{click:function(t){return t.stopPropagation(),i.handleEdit(e.row)}}}),i._v(" "),n("el-button",{attrs:{type:"text",size:"small",icon:"el-icon-delete"},on:{click:function(t){return t.stopPropagation(),i.handleRemove(e.row)}}})]}}])})],1)],1),i._v(" "),n("el-dialog",{attrs:{visible:i.mainFormDialogVisible,"close-on-click-modal":!1,width:"780px"},on:{"update:visible":function(t){i.mainFormDialogVisible=t}},nativeOn:{submit:function(t){t.preventDefault()}}},[n("span",{attrs:{slot:"title"},slot:"title"},[i._v("\r\n          "+i._s(i.editActive?"编辑":"添加")+"\r\n        ")]),i._v(" "),n("el-form",{ref:"mainForm",attrs:{model:i.mainForm,rules:i.mainFormRules,"label-position":"right","label-width":"120px"}},[n("el-form-item",{attrs:{label:"标题",prop:"title",placeholder:"请输入标题"}},[n("el-input",{attrs:{type:"text"},model:{value:i.mainForm.title,callback:function(t){i.$set(i.mainForm,"title",t)},expression:"mainForm.title"}})],1),i._v(" "),n("el-form-item",{attrs:{label:"消息",prop:"message",placeholder:"请输入简称"}},[n("quill-editor",{ref:"messageEditor",attrs:{options:i.editorOption},model:{value:i.mainForm.message,callback:function(t){i.$set(i.mainForm,"message",t)},expression:"mainForm.message"}})],1)],1),i._v(" "),n("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[n("el-button",{on:{click:function(t){return i.handleMainFormSure(!1)}}},[i._v("取 消")]),i._v(" "),n("el-button",{attrs:{type:"primary"},on:{click:function(t){return i.handleMainFormSure(!0)}}},[i._v("确 定")])],1)],1)],1),i._v(" "),n("el-footer",{staticClass:"footer"},[i.page.totalItemCount?n("el-pagination",{attrs:{"current-page":i.searchCriteriaForm.pagingInfo.pageNumber,"page-sizes":[20,50,100,200,400],"page-size":i.searchCriteriaForm.pagingInfo.pageSize,layout:"total, sizes, prev, pager, next, jumper",total:i.page.totalItemCount},on:{"size-change":i.handlePaginationSizeChange,"current-change":i.handlePaginationCurrentChange}}):i._e()],1)],1)},staticRenderFns:[]};e.a=n},CbDO:function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=i("tvR6"),o=(i.n(n),i("qBF2")),r=i.n(o),a=i("7+uW"),l=i("/rEA"),s=i("/7iZ"),u=i.n(s),c=i("uN2V"),d=(i.n(c),i("q+7M"));a.default.config.productionTip=!1,a.default.use(l.a),a.default.use(u.a),a.default.use(r.a,{size:"mini"}),new a.default({el:"#app",render:function(t){return t(d.a)}})},MUOT:function(t,e,i){"use strict";var n=i("VsUZ");e.a={data:function(){return{isLoading:!1,editorOption:{placeholder:"请输入消息"},page:{list:null,totalItemCount:null,totalPageCount:null},searchCriteriaForm:{keyword:null,toUserId:null,creationTime:null,creationTimeBegin:null,creationTimeEnd:null,pagingInfo:{pageNumber:1,pageSize:20,isExcludeMetaData:!1,sortInfo:{sort:"NotificationId",sortDir:"DESC"}}},removeActive:null,editActive:null,mainFormDialogVisible:!1,mainForm:{notificationId:null,title:null,message:null},mainFormRules:{title:[{required:!0,message:"请输入标题",trigger:"blur"},{max:100,message:"最多支持100个字符",trigger:"blur"}],message:[{required:!0,message:"请输入消息",trigger:"blur"},{max:1e3,message:"最多支持1000个字符",trigger:"blur"}]}}},mounted:function(){this.getPage()},computed:{mainTableEmptyText:function(){return this.isLoading?"加载中...":"暂无数据"}},watch:{},methods:{getPage:function(){var e=this;this.isLoading=!0;var t=this.searchCriteriaForm;n.a.getNotificationsForManager(t).then(function(t){e.isLoading=!1,e.page=t.data.data},function(t){e.isLoading=!1,e.$message.error(t.message)})},handlePaginationSizeChange:function(t){this.searchCriteriaForm.pagingInfo.pageSize=t,this.searchCriteriaForm.pagingInfo.pageNumber=1,this.getPage()},handlePaginationCurrentChange:function(t){this.searchCriteriaForm.pagingInfo.pageNumber=t,this.getPage()},handleSearchAll:function(){this.searchCriteriaForm.pagingInfo.pageNumber=1,this.searchCriteriaForm.keyword=null,this.getPage()},handleSearch:function(){this.searchCriteriaForm.pagingInfo.pageNumber=1,this.searchCriteriaForm.creationTime&&2===this.searchCriteriaForm.creationTime.length&&(this.searchCriteriaForm.creationTimeBegin=this.searchCriteriaForm.creationTime[0],this.searchCriteriaForm.creationTimeEnd=this.searchCriteriaForm.creationTime[1]),this.getPage()},handleAdd:function(){var t=this;this.editActive=null,this.mainFormDialogVisible=!0,this.mainForm.notificationId=null,this.mainForm.title=null,this.mainForm.message=null,this.$nextTick(function(){t.clearValidate("mainForm")})},handleEdit:function(t){var e=this;console.log("handleEdit",t),this.editActive=t,this.mainFormDialogVisible=!0,this.mainForm.notificationId=t.notificationId,this.mainForm.title=t.title,this.mainForm.message=t.message,this.$nextTick(function(){e.clearValidate("mainForm")})},handleMainFormSure:function(t){console.log("handleMainFormSure",t),t?this.editActive?this.edit():this.add():this.mainFormDialogVisible=!1},handleRemove:function(t){var e=this;this.removeActive=t,this.$confirm("删除该通知后，相关的数据也将被删除。是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){e.remove()}).catch(function(){e.removeActive=null})},add:function(){var i=this;this.$refs.mainForm.validate(function(t){if(!t)return!1;i.isLoading=!0;var e=i.mainForm;n.a.addNotification(e).then(function(t){i.isLoading=!1,i.mainFormDialogVisible=!1,i.getPage()},function(t){i.isLoading=!1,i.$message.error(t.message)})})},edit:function(){var i=this;this.editActive?this.$refs.mainForm.validate(function(t){if(!t)return!1;i.isLoading=!0;var e=i.mainForm;n.a.editNotification(e).then(function(t){i.isLoading=!1,i.editActive=null,i.mainFormDialogVisible=!1,i.getPage()},function(t){i.isLoading=!1,i.$message.error(t.message)})}):this.$message.error("异常：无编辑目标")},remove:function(){var e=this;if(this.removeActive){var t={notificationId:this.removeActive.notificationId};this.isLoading=!0,n.a.removeNotification(t).then(function(t){e.isLoading=!1,e.removeActive=null,e.getPage()},function(t){e.isLoading=!1,e.$message.error(t.message)})}},resetForm:function(t){this.$refs[t].resetFields()},clearValidate:function(t){this.$refs[t].clearValidate()},handleRowClick:function(t,e,i){"el-table_1_column_1"!==i.id&&this.$refs.mainTable.toggleRowExpansion(t)},handleSortChange:function(t){this.searchCriteriaForm.pagingInfo.sortInfo.sort=t.prop,this.searchCriteriaForm.pagingInfo.sortInfo.sortDir="descending"===t.order?"DESC":"ASC",this.searchCriteriaForm.pagingInfo.pageNumber=1,this.getPage()}}}},V84S:function(t,e,i){"use strict";i("4qOc"),i("+cgv"),i("3f40"),window.Quill||(window.Quill=i("yPE/")),e.a={name:"quill-editor",data:function(){return{_content:"",defaultModules:{toolbar:[["bold","italic","underline","strike"],["blockquote","code-block"],[{header:1},{header:2}],[{list:"ordered"},{list:"bullet"}],[{script:"sub"},{script:"super"}],[{indent:"-1"},{indent:"+1"}],[{direction:"rtl"}],[{size:["small",!1,"large","huge"]}],[{header:[1,2,3,4,5,6,!1]}],[{color:[]},{background:[]}],[{font:[]}],[{align:[]}],["clean"],["link","image","video"]]}}},props:{content:String,value:String,disabled:Boolean,options:{type:Object,required:!1,default:function(){return{}}}},mounted:function(){this.initialize()},beforeDestroy:function(){this.quill=null},methods:{initialize:function(){if(this.$el){var r=this;r.options.theme=r.options.theme||"snow",r.options.boundary=r.options.boundary||document.body,r.options.modules=r.options.modules||r.defaultModules,r.options.modules.toolbar=void 0!==r.options.modules.toolbar?r.options.modules.toolbar:r.defaultModules.toolbar,r.options.placeholder=r.options.placeholder||"Insert text here ...",r.options.readOnly=void 0!==r.options.readOnly&&r.options.readOnly,r.quill=new Quill(r.$refs.editor,r.options),(r.value||r.content)&&r.quill.pasteHTML(r.value||r.content),r.quill.on("selection-change",function(t){t?r.$emit("focus",r.quill):r.$emit("blur",r.quill)}),r.quill.on("text-change",function(t,e,i){var n=r.$refs.editor.children[0].innerHTML,o=r.quill.getText();"<p><br></p>"===n&&(n=""),r._content=n,r.$emit("input",r._content),r.$emit("change",{editor:r.quill,html:n,text:o})}),this.disabled&&this.quill.enable(!1),r.$emit("ready",r.quill)}}},watch:{content:function(t,e){this.quill&&(t&&t!==this._content?(this._content=t,this.quill.pasteHTML(t)):t||this.quill.setText(""))},value:function(t,e){this.quill&&(t&&t!==this._content?(this._content=t,this.quill.pasteHTML(t)):t||this.quill.setText(""))},disabled:function(t,e){this.quill&&this.quill.enable(!t)}}}},VsUZ:function(t,e,i){"use strict";var n=i("7+uW");e.a={login:function(t){return n.default.httpClient.post("/admin/login",t)},refreshToken:function(t){return n.default.httpClient.post("/admin/refreshToken",t)},logout:function(){return n.default.httpClient.post("/admin/logout")},getProfile:function(){return n.default.httpClient.get("/admin/getProfile")},changeProfile:function(t){return n.default.httpClient.post("/admin/changeProfile",t)},changeAvatar:function(t){return n.default.uploadHttpClient.post("/admin/ChangeAvatar",t)},changeLogo:function(t){return n.default.uploadHttpClient.post("/admin/ChangeLogo",t)},changePassword:function(t){return n.default.httpClient.post("/admin/changePassword",t)},getMenus:function(){return n.default.httpClient.get("/admin/getMenus")},getBulletin:function(){return n.default.httpClient.get("/admin/getBulletin")},editBulletin:function(t){return n.default.httpClient.post("/admin/editBulletin",t)},getModuleMetaDatas:function(){return n.default.httpClient.get("/admin/getModuleMetaDatas")},extractModuleMetaDatas:function(){return n.default.httpClient.get("/admin/extractModuleMetaDatas")},clearModulePermissions:function(){return n.default.httpClient.get("/admin/clearModulePermissions")},getRoleList:function(){return n.default.httpClient.get("/admin/getRoleList")},addRole:function(t){return n.default.httpClient.post("/admin/addRole",t)},editRole:function(t){return n.default.httpClient.post("/admin/editRole",t)},removeRole:function(t){return n.default.httpClient.post("/admin/removeRole",t)},moveRole:function(t){return n.default.httpClient.post("/admin/moveRole",t)},saveRoleName:function(t){return n.default.httpClient.post("/admin/saveRoleName",t)},getGroupTree:function(){return n.default.httpClient.get("/admin/getGroupTree")},addGroup:function(t){return n.default.httpClient.post("/admin/addGroup",t)},editGroup:function(t){return n.default.httpClient.post("/admin/editGroup",t)},removeGroup:function(t){return n.default.httpClient.post("/admin/removeGroup",t)},moveGroup:function(t){return n.default.httpClient.post("/admin/moveGroup",t)},getUserPage:function(t){return n.default.httpClient.post("/admin/getUserPage",t)},addUser:function(t){return n.default.httpClient.post("/admin/addUser",t)},editUser:function(t){return n.default.httpClient.post("/admin/editUser",t)},removeUser:function(t){return n.default.httpClient.post("/admin/removeUser",t)},getUserStatuList:function(){return n.default.httpClient.get("/admin/getUserStatuList")},changeUserAvatar:function(t){return n.default.uploadHttpClient.post("/admin/ChangeUserAvatar",t)},changeUserLogo:function(t){return n.default.uploadHttpClient.post("/admin/ChangeUserLogo",t)},getNotificationsForManager:function(t){return n.default.httpClient.post("/admin/getNotificationsForManager",t)},addNotification:function(t){return n.default.httpClient.post("/admin/addNotification",t)},editNotification:function(t){return n.default.httpClient.post("/admin/editNotification",t)},removeNotification:function(t){return n.default.httpClient.post("/admin/removeNotification",t)},getNotifications:function(t){return n.default.httpClient.post("/admin/getNotifications",t)},readNotifications:function(t){return n.default.httpClient.post("/admin/readNotifications",t)},deleteNotifications:function(t){return n.default.httpClient.post("/admin/deleteNotifications",t)},getNewestNotification:function(t){return n.default.httpClient.post("/admin/getNewestNotification",t)},getGroupList:function(){return n.default.httpClient.get("/admin/getGroupList")},getRoleBaseList:function(){return n.default.httpClient.get("/admin/getRoleBaseList")},getPermissionTree:function(){return n.default.httpClient.get("/admin/getPermissionTree")},callDirectly:function(t){return n.default.httpClient.get(t)},download:function(t,e){return n.default.httpClient.post(t,e,{responseType:"arraybuffer"})}}},bJDK:function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=i("V84S"),o=i("gJGC");function r(t){i("5lsP")}var a=i("VU/8")(n.a,o.a,!1,r,null,null);e.default=a.exports},bzuE:function(t,e,i){"use strict";i.d(e,"a",function(){return n}),i.d(e,"b",function(){return o}),i.d(e,"c",function(){return r});var n="/api",o="",r=""},gJGC:function(t,e,i){"use strict";var n={render:function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"quill-editor"},[this._t("toolbar"),this._v(" "),e("div",{ref:"editor"})],2)},staticRenderFns:[]};e.a=n},"q+7M":function(t,e,i){"use strict";var n=i("MUOT"),o=i("9fPD");function r(t){i("72kH")}var a=i("VU/8")(n.a,o.a,!1,r,null,null);e.a=a.exports},tvR6:function(t,e){},uN2V:function(t,e){}},["CbDO"]);
//# sourceMappingURL=notificationmanage.js.map